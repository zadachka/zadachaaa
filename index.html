<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Zadacha</title>
    <style>
        body {
            font-family: system-ui, Arial, sans-serif;
            margin: 0;
            background: #f5f5f5;
            -webkit-tap-highlight-color: transparent;
        }
        .header {
            background: white;
            padding: 12px 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #ddd;
            font-size: 18px;
        }
        .nav {
            display: flex;
            gap: 8px;
        }
        .nav button {
            background: none;
            border: none;
            font-size: 15px;
            cursor: pointer;
            padding: 5px 12px;
            border-radius: 8px;
            transition: background 0.3s;
        }
        .nav button.active {
            background-color: #007bff;
            color: white;
        }
        .content {
            padding: 8px;
            max-width: 460px;
            margin: 0 auto;
        }
        .task, .profile-card, .withdraw-card {
            background: white;
            border-radius: 14px;
            padding: 12px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }
        .task-title {
            font-weight: bold;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 7px;
            font-size: 16px;
        }
        .task-desc {
            margin-bottom: 10px;
            color: #333;
            font-size: 14px;
        }
        .task-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .task-footer span {
            font-size: 12px;
            color: #555;
        }
        .start-btn, .withdraw-btn, .back-btn, .check-btn, .tg-btn {
            background-color: #007bff;
            color: white;
            padding: 10px 0;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 15px;
            width: 100%;
            margin-top: 5px;
            margin-bottom: 2px;
            transition: background 0.3s, transform 0.1s;
        }
        .start-btn:disabled {background: #aaa; cursor: default;}
        .start-btn:hover:not(:disabled),
        .withdraw-btn:hover:not(:disabled),
        .back-btn:hover,
        .check-btn:hover,
        .tg-btn:hover {background-color: #0056b3;}
        .start-btn:active,
        .withdraw-btn:active,
        .back-btn:active,
        .check-btn:active,
        .tg-btn:active {transform: scale(0.97);}
        .hidden {display: none;}
        .done-label {
            display: inline-block;
            color: #36a82e;
            background: #e9f9e7;
            padding: 2px 10px;
            border-radius: 8px;
            margin-top: 8px;
            font-size: 13px;
        }
        .modal-bg {
            position: fixed;
            z-index: 99;
            left: 0; top: 0; right: 0; bottom: 0;
            width: 100vw; height: 100vh;
            background: rgba(0,0,0,0.24);
            display: none;
            align-items: center;
            justify-content: center;
        }
        .modal-bg.show {display: flex;}
        .modal {
            background: #fff;
            border-radius: 18px;
            padding: 20px 10px 12px 10px;
            max-width: 96vw;
            width: 98vw;
            box-shadow: 0 8px 36px rgba(0,0,0,0.13);
            text-align: center;
            position: relative;
        }
        .modal input[type="text"],
        .modal input[type="file"] {
            width: 97%;
            margin: 10px 0 14px 0;
            padding: 10px;
            font-size: 15px;
            border-radius: 8px;
            border: 1px solid #ccc;
        }
        .modal .close-btn {
            position: absolute;
            top: 7px;
            right: 11px;
            background: none;
            border: none;
            font-size: 26px;
            color: #aaa;
            cursor: pointer;
        }
        .notify {
            position: fixed;
            z-index: 120;
            left: 50%; top: 36px;
            transform: translateX(-50%);
            background: #222;
            color: #fff;
            border-radius: 15px;
            padding: 13px 22px;
            font-size: 16px;
            opacity: 0; pointer-events: none;
            transition: opacity 0.3s;
            box-shadow: 0 2px 14px rgba(0,0,0,0.11);
        }
        .notify.show {opacity: 1;}
        .subscribe-modal .modal {padding-top: 26px;}
        .subscribe-list {
            text-align: left;
            margin: 14px 0 18px 0;
            font-size: 15px;
            padding-left: 0;
        }
        .subscribe-list li {margin-bottom: 7px;}
        .check-btn, .tg-btn {margin: 11px 0 0 0;}
        .withdraw-btn[disabled] {background: #aaa; cursor: default;}
        .withdraw-hint {
            font-size: 13px;
            color: #d13c3c;
            margin-top: 8px;
        }
        input, button, select, textarea {font-family: inherit;}
        @media (max-width: 600px) {
            .content {padding: 2vw;}
            .modal {width: 99vw; padding: 13px 2vw;}
            .modal input[type="text"], .modal input[type="file"] {font-size: 16px;}
            .start-btn, .withdraw-btn, .back-btn, .check-btn, .tg-btn {font-size: 16px;}
        }
        @media (max-width: 400px) {
            .modal input[type="text"], .modal input[type="file"] {font-size: 14px;}
            .task-title, .profile-card h2 {font-size: 15px;}
        }
    </style>
</head>
<body>
    <div class="header">
        <span>‚úÖ Zadacha</span>
        <div class="nav">
            <button class="tab-btn active" data-tab="tasks">–ó–∞–¥–∞–Ω–∏—è</button>
            <button class="tab-btn" data-tab="profile">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</button>
        </div>
    </div>
    <div class="content">
        <!-- –ó–ê–î–ê–ù–ò–Ø -->
        <div id="tasks-section">
            <div class="task" id="task-card-1">
                <div class="task-title">üîç –ó–∞–¥–∞–Ω–∏–µ 1</div>
                <div class="task-desc">–ù–∞–π–¥–∏ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç –∫–æ–º–ø–∞–Ω–∏–∏ ¬´–ö–æ—Å–º–æ–¢–µ—Ö¬ª</div>
                <div class="task-footer">
                    <span>10 –º–∏–Ω ‚Ä¢ 100 ‚ÇΩ</span>
                    <button class="start-btn" id="start-task1">–ù–∞—á–∞—Ç—å ‚Üí</button>
                </div>
            </div>
            <div class="task" id="task-card-2">
                <div class="task-title">üì∑ –ó–∞–¥–∞–Ω–∏–µ 2</div>
                <div class="task-desc">–ó–∞–≥—Ä—É–∑–∏ —Ñ–æ—Ç–æ —Å —É–ª–∏—Ü—ã —Å –ø–æ–≥–æ–¥–æ–π —Å–µ–≥–æ–¥–Ω—è</div>
                <div class="task-footer">
                    <span>5 –º–∏–Ω ‚Ä¢ 150 ‚ÇΩ</span>
                    <button class="start-btn" id="start-task2">–ù–∞—á–∞—Ç—å ‚Üí</button>
                </div>
            </div>
            <div class="task" id="task-card-3">
                <div class="task-title">üßπ –ó–∞–¥–∞–Ω–∏–µ 3</div>
                <div class="task-desc">–û—á–∏—Å—Ç–∏ —Å –æ–±–ª–∞—á–Ω–æ–≥–æ –¥–∏—Å–∫–∞ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Ñ–æ—Ç–æ (200 —Ñ–∞–π–ª–æ–≤)</div>
                <div class="task-footer">
                    <span>7 –º–∏–Ω ‚Ä¢ 700 ‚ÇΩ</span>
                    <button class="start-btn" id="start-task3" disabled>–ù–∞—á–∞—Ç—å ‚Üí</button>
                </div>
            </div>
        </div>
        <!-- –õ–ò–ß–ù–´–ô –ö–ê–ë–ò–ù–ï–¢ -->
        <div id="profile-section" class="hidden">
            <div class="profile-card">
                <h2>üë§ –ü—Ä–∏–≤–µ—Ç, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h2>
                <p class="profile-info">–ë–∞–ª–∞–Ω—Å: <strong id="profile-balance">0 ‚ÇΩ</strong></p>
                <p class="profile-info">–í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–¥–∞–Ω–∏–π: <strong id="profile-tasks">0</strong></p>
                <button class="withdraw-btn" id="go-withdraw" disabled>–í—ã–≤–µ—Å—Ç–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞</button>
                <div class="withdraw-hint" id="withdraw-hint" style="display:none;">
                    –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞ ‚Äî 1000 ‚ÇΩ
                </div>
            </div>
        </div>
        <!-- –í–´–í–û–î –°–†–ï–î–°–¢–í -->
        <div id="withdraw-section" class="hidden">
            <div class="withdraw-card">
                <h2>–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –≤—ã–≤–æ–¥–∞</h2>
                <div class="withdraw-option">üí≥ –í—ã–≤–µ—Å—Ç–∏ –Ω–∞ –∫–∞—Ä—Ç—É</div>
                <div class="withdraw-option">üéÅ –ü–æ–¥–∞—Ä–æ—á–Ω–∞—è –∫–∞—Ä—Ç–∞ Wildberries</div>
                <div class="withdraw-option">üéÆ –ë–∞–ª–∞–Ω—Å Steam</div>
                <button class="back-btn" id="back-profile">‚Üê –ù–∞–∑–∞–¥</button>
            </div>
        </div>
    </div>
    <!-- –ú–û–î–ê–õ–ö–ò –ó–ê–î–ê–ù–ò–ô -->
    <div class="modal-bg" id="modal-task1">
        <div class="modal">
            <button class="close-btn" id="close-modal-task1">&times;</button>
            <div class="task-title">üîç –ó–∞–¥–∞–Ω–∏–µ 1</div>
            <div style="font-size:15px; margin:5px 0 10px 0;">–ù–∞–π–¥–∏ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç –∫–æ–º–ø–∞–Ω–∏–∏ ¬´–ö–æ—Å–º–æ–¢–µ—Ö¬ª –∏ –≤—Å—Ç–∞–≤—å —Å—Å—ã–ª–∫—É –Ω–∏–∂–µ:</div>
            <input type="text" id="task1-url" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ —Å–∞–π—Ç">
            <button class="start-btn" id="submit-task1">–ì–æ—Ç–æ–≤–æ</button>
        </div>
    </div>
    <div class="modal-bg" id="modal-task2">
        <div class="modal">
            <button class="close-btn" id="close-modal-task2">&times;</button>
            <div class="task-title">üì∑ –ó–∞–¥–∞–Ω–∏–µ 2</div>
            <div style="font-size:15px; margin:5px 0 10px 0;">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ —É–ª–∏—Ü—ã —Å –ø–æ–≥–æ–¥–æ–π —Å–µ–≥–æ–¥–Ω—è:</div>
            <input type="file" id="task2-photo" accept="image/*">
            <button class="start-btn" id="submit-task2">–ì–æ—Ç–æ–≤–æ</button>
        </div>
    </div>
    <div class="modal-bg" id="modal-task3">
        <div class="modal">
            <button class="close-btn" id="close-modal-task3">&times;</button>
            <div class="task-title">üßπ –ó–∞–¥–∞–Ω–∏–µ 3</div>
            <div style="font-size:15px; margin:5px 0 10px 0;">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ, —á—Ç–æ —É–¥–∞–ª–∏–ª–∏ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Ñ–æ—Ç–æ (200 —Ñ–∞–π–ª–æ–≤):</div>
            <input type="text" id="task3-confirm" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ: –ì–æ—Ç–æ–≤–æ, —É–¥–∞–ª–∏–ª!">
            <button class="start-btn" id="submit-task3">–ì–æ—Ç–æ–≤–æ</button>
        </div>
    </div>
    <!-- –ú–û–î–ê–õ–ö–ê –ü–û–î–ü–ò–°–ö–ò -->
    <div class="modal-bg subscribe-modal" id="modal-subscribe">
        <div class="modal">
            <div style="font-size:17px; font-weight:500; margin-bottom:4px;">–î–æ—Å—Ç—É–ø –∫ 3 –∑–∞–¥–∞–Ω–∏—é</div>
            <ul class="subscribe-list" id="subscribe-list">
                <li>1. –ü–µ—Ä–µ–π–¥–∏ –≤ –Ω–∞—à–µ–≥–æ Telegram-–±–æ—Ç–∞</li>
                <li>2. –ï—Å–ª–∏ –±–æ—Ç –Ω–µ –ø—Ä–∏—Å–ª–∞–ª –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ ‚Äî –Ω–∞–ø–∏—à–∏ <b>–ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥</b></li>
                <li>3. –ü–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ –∫–∞–Ω–∞–ª —Å–ø–æ–Ω—Å–æ—Ä–∞</li>
                <li>4. –ù–∞–∂–º–∏ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫–∏"</li>
                <li>5. –í–≤–µ–¥–∏ –∫–æ–¥ –∏–∑ –±–æ—Ç–∞ –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å 3-–µ –∑–∞–¥–∞–Ω–∏–µ</li>
            </ul>
            <a href="https://t.me/zzadacha_bot?start=getcode" target="_blank" class="tg-btn" style="margin-bottom:10px;">–ü–µ—Ä–µ–π—Ç–∏ –≤ –±–æ—Ç</a>
            <input type="text" id="access-code-input" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞">
            <button class="check-btn" id="check-access-code">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥</button>
        </div>
    </div>
    <div class="notify" id="notify"></div>
    <script>
        // ====== –õ–û–ì–ò–ö–ê ======
        let tasksDone = JSON.parse(localStorage.getItem("tasksDone")) || [false, false, false];
        let taskPays = [100, 150, 700];
        let balance = Number(localStorage.getItem("balance")) || 0;
        let doneTasks = Number(localStorage.getItem("doneTasks")) || 0;
        let canOpenThirdTask = localStorage.getItem("canOpenThirdTask") === "true";

        function saveProgress() {
            localStorage.setItem("tasksDone", JSON.stringify(tasksDone));
            localStorage.setItem("balance", balance.toString());
            localStorage.setItem("doneTasks", doneTasks.toString());
            localStorage.setItem("canOpenThirdTask", canOpenThirdTask ? "true" : "false");
        }

        function updateProfile() {
            document.getElementById("profile-balance").innerText = balance + " ‚ÇΩ";
            document.getElementById("profile-tasks").innerText = doneTasks;
            const withdrawBtn = document.getElementById("go-withdraw");
            const hint = document.getElementById("withdraw-hint");
            if (balance >= 1000) {
                withdrawBtn.disabled = false;
                hint.style.display = "none";
            } else {
                withdrawBtn.disabled = true;
                hint.style.display = "block";
            }
        }

        function setTaskDone(idx) {
            tasksDone[idx] = true;
            const card = document.getElementById("task-card-" + (idx+1));
            if (!card.querySelector('.done-label')) {
                const label = document.createElement('div');
                label.className = 'done-label';
                label.innerText = '–í—ã–ø–æ–ª–Ω–µ–Ω–æ!';
                card.appendChild(label);
            }
            document.getElementById("start-task"+(idx+1)).disabled = true;
            saveProgress();
        }

        function showNotify(message) {
            const notify = document.getElementById("notify");
            notify.textContent = message;
            notify.classList.add("show");
            setTimeout(() => {notify.classList.remove("show");}, 2300);
        }

        function showModal(id) {
            document.getElementById(id).classList.add("show");
        }
        function closeModal(id) {
            document.getElementById(id).classList.remove("show");
        }

        // Tabs
        const tabButtons = document.querySelectorAll(".tab-btn");
        const tasksSection = document.getElementById("tasks-section");
        const profileSection = document.getElementById("profile-section");
        const withdrawSection = document.getElementById("withdraw-section");
        const goWithdraw = document.getElementById("go-withdraw");
        const backProfile = document.getElementById("back-profile");

        tabButtons.forEach(button => {
            button.addEventListener("click", () => {
                tabButtons.forEach(btn => btn.classList.remove("active"));
                button.classList.add("active");
                tasksSection.classList.add("hidden");
                profileSection.classList.add("hidden");
                withdrawSection.classList.add("hidden");
                if (button.dataset.tab === "tasks") tasksSection.classList.remove("hidden");
                else profileSection.classList.remove("hidden");
            });
        });
        goWithdraw && goWithdraw.addEventListener("click", () => {
            profileSection.classList.add("hidden");
            withdrawSection.classList.remove("hidden");
        });
        backProfile && backProfile.addEventListener("click", () => {
            withdrawSection.classList.add("hidden");
            profileSection.classList.remove("hidden");
        });

        // –ú–æ–¥–∞–ª–∫–∏ –ø–æ –∑–∞–¥–∞–Ω–∏—è–º
        document.getElementById("start-task1").addEventListener("click", () => {
            if (!tasksDone[0]) showModal("modal-task1");
        });
        document.getElementById("close-modal-task1").addEventListener("click", () => closeModal("modal-task1"));
        document.getElementById("submit-task1").addEventListener("click", () => {
            if (tasksDone[0]) return;
            const url = document.getElementById("task1-url").value.trim();
            if (url === "" || !url.startsWith("http")) {
                showNotify("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—Å—ã–ª–∫—É –Ω–∞ —Å–∞–π—Ç.");
                return;
            }
            balance += taskPays[0];
            doneTasks += 1;
            updateProfile();
            showNotify("–ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ! –ù–∞ –≤–∞—à –±–∞–ª–∞–Ω—Å –∑–∞—á–∏—Å–ª–µ–Ω–æ 100 ‚ÇΩ");
            setTaskDone(0);
            closeModal("modal-task1");
            document.getElementById("task1-url").value = "";
            checkAfterTwoTasks();
            saveProgress();
        });

        document.getElementById("start-task2").addEventListener("click", () => {
            if (!tasksDone[1]) showModal("modal-task2");
        });
        document.getElementById("close-modal-task2").addEventListener("click", () => closeModal("modal-task2"));
        document.getElementById("submit-task2").addEventListener("click", () => {
            if (tasksDone[1]) return;
            const fileInput = document.getElementById("task2-photo");
            if (fileInput.files.length === 0) {
                showNotify("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é.");
                return;
            }
            balance += taskPays[1];
            doneTasks += 1;
            updateProfile();
            showNotify("–ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ! –ù–∞ –≤–∞—à –±–∞–ª–∞–Ω—Å –∑–∞—á–∏—Å–ª–µ–Ω–æ 150 ‚ÇΩ");
            setTaskDone(1);
            closeModal("modal-task2");
            fileInput.value = "";
            checkAfterTwoTasks();
            saveProgress();
        });

        document.getElementById("start-task3").addEventListener("click", () => {
            if (!tasksDone[2] && canOpenThirdTask) showModal("modal-task3");
        });
        document.getElementById("close-modal-task3").addEventListener("click", () => closeModal("modal-task3"));
        document.getElementById("submit-task3").addEventListener("click", () => {
            if (tasksDone[2]) return;
            const confirmInput = document.getElementById("task3-confirm").value.trim();
            if (confirmInput.length < 2) {
                showNotify("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.");
                return;
            }
            balance += taskPays[2];
            doneTasks += 1;
            updateProfile();
            showNotify("–ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ! –ù–∞ –≤–∞—à –±–∞–ª–∞–Ω—Å –∑–∞—á–∏—Å–ª–µ–Ω–æ 700 ‚ÇΩ");
            setTaskDone(2);
            closeModal("modal-task3");
            document.getElementById("task3-confirm").value = "";
            saveProgress();
        });

        function checkAfterTwoTasks() {
            if (tasksDone[0] && tasksDone[1] && !canOpenThirdTask) {
                showModal("modal-subscribe");
            }
        }
        // –ö–û–î –î–û–°–¢–£–ü–ê –¥–ª—è —Ç—Ä–µ—Ç—å–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è
        const SECRET_CODE = "Zadacha2025";
        document.getElementById("check-access-code").addEventListener("click", () => {
            const code = document.getElementById("access-code-input").value.trim();
            if (code === SECRET_CODE) {
                canOpenThirdTask = true;
                closeModal("modal-subscribe");
                showNotify("–î–æ—Å—Ç—É–ø –∫ 3 –∑–∞–¥–∞–Ω–∏—é –æ—Ç–∫—Ä—ã—Ç!");
                document.getElementById("start-task3").disabled = false;
                saveProgress();
            } else {
                showNotify("–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞!");
            }
        });

        // INIT
        window.addEventListener('DOMContentLoaded', function() {
            for (let i = 0; i < tasksDone.length; i++) {
                if (tasksDone[i]) setTaskDone(i);
            }
            if (canOpenThirdTask) {
                document.getElementById("start-task3").disabled = false;
            }
            updateProfile();
        });
    </script>
</body>
</html>
