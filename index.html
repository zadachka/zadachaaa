<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
  <title>Zadacha</title>
  <style>
    html,body{margin:0;padding:0;height:100%;font-family:system-ui,Arial,sans-serif;background:#f5f5f5;color:#191a1b;}
    *,*:before,*:after{box-sizing:border-box;}
    .header{background:#fff;color:#191a1b;padding:15px 10px 13px 10px;font-size:20px;font-weight:600;border-bottom:1px solid #ececec;text-align:center;}
    .nav{margin:10px 0 18px 0;display:flex;gap:8px;justify-content:center;}
    .tab-btn{background:#f1f1f1;color:#191a1b;border:none;border-radius:9px;font-size:15px;padding:6px 14px;cursor:pointer;font-weight:500;transition:background 0.16s;}
    .tab-btn.active{background:#007bff;color:#fff;}
    .content{max-width:430px;margin:0 auto;padding:8px 3px 24px 3px;}
    .task,.profile-card{background:#fff;border-radius:14px;padding:15px 12px 13px 12px;margin-bottom:13px;box-shadow:0 2px 8px rgba(0,0,0,0.06);}
    .task-title{font-weight:700;margin-bottom:8px;font-size:16.6px;display:flex;align-items:center;gap:8px;}
    .task-desc{margin-bottom:12px;color:#3e3e3e;font-size:14.3px;}
    .task-footer{display:flex;justify-content:space-between;align-items:center;}
    .task-footer span{font-size:12.5px;color:#6b6b6b;}
    .my-btn,.tg-btn{background:#007bff;color:#fff;font-weight:500;padding:11px 0;border:none;border-radius:10px;width:100%;font-size:16px;cursor:pointer;margin-top:5px;margin-bottom:2px;transition:background .16s,box-shadow .15s;}
    .my-btn:active,.tg-btn:active{background:#0056b3;}
    .my-btn:disabled{background:#bdbdbd;color:#fff;cursor:not-allowed;}
    .my-input{width:100%;padding:12px;border-radius:8px;border:1.2px solid #d1d1d1;background:#f9f9fa;color:#181a1c;margin-bottom:13px;font-size:15.6px;outline:none;transition:border .17s;}
    .my-input:focus{border:1.2px solid #007bff;background:#fff;}
    .done-label{display:inline-block;color:#34ba43;background:#e6f7ea;padding:3px 13px;border-radius:10px;margin-top:9px;font-size:14px;font-weight:500;}
    .lock-label{color:#d13c3c;background:#fde6e6;border-radius:8px;padding:6px 12px;margin-top:13px;font-size:15px;font-weight:500;}
    .hidden{display:none;}
    .modal-bg{position:fixed;z-index:99;left:0;top:0;right:0;bottom:0;width:100vw;height:100vh;background:rgba(0,0,0,0.18);display:none;align-items:center;justify-content:center;}
    .modal-bg.show{display:flex;}
    .modal{background:#fff;border-radius:18px;padding:23px 13px 13px 13px;max-width:97vw;width:97vw;box-shadow:0 8px 36px rgba(0,0,0,0.13);text-align:center;position:relative;color:#161718;}
    .modal .close-btn{position:absolute;top:8px;right:11px;background:none;border:none;font-size:28px;color:#999;cursor:pointer;}
    .notify{position:fixed;z-index:1200;left:50%;top:38px;transform:translateX(-50%);background:#232323;color:#fff;border-radius:15px;padding:13px 22px;font-size:16.5px;opacity:0;pointer-events:none;transition:opacity 0.3s;box-shadow:0 2px 14px rgba(0,0,0,0.12);}
    .notify.show{opacity:1;}
    @media (max-width:600px){.content{padding:1vw;}.modal{width:99vw;padding:13px 2vw;}.my-btn,.tg-btn{font-size:16.4px;}.my-input{font-size:15.3px;}}
    @media (max-width:400px){.my-input{font-size:13.6px;}.task-title{font-size:14.7px;}}
    @media (prefers-color-scheme:dark){
      html,body{background:#181a20!important;color:#f4f4f4!important;}
      .header{background:#23242a!important;color:#fff!important;border-bottom:1px solid #2d2d34!important;}
      .task,.profile-card{background:#202126!important;color:#f4f4f4!important;box-shadow:0 2px 8px rgba(0,0,0,0.17)!important;}
      .task-desc{color:#b3b5b8!important;}
      .task-footer span{color:#aaa!important;}
      .done-label{color:#54dd80!important;background:#142017!important;}
      .modal{background:#20222b!important;color:#f4f4f4!important;box-shadow:0 8px 36px rgba(0,0,0,0.34)!important;}
      .my-input{background:#23242a!important;color:#fff!important;border:1.2px solid #373744!important;}
      .my-input:focus{border:1.2px solid #44a1ff!important;background:#23242a!important;}
      .my-btn,.tg-btn{background:#3089ff!important;color:#fff!important;}
      .my-btn:disabled{background:#40424c!important;color:#888!important;}
      .lock-label{color:#ff8989!important;background:#2d1818!important;}
      .notify{background:#252733!important;color:#fff!important;}
    }
  </style>
</head>
<body>
  <div class="header">Zadacha</div>
  <div class="content">
    <div class="nav">
      <button class="tab-btn active" data-tab="tasks">–ó–∞–¥–∞–Ω–∏—è</button>
      <button class="tab-btn" data-tab="profile">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</button>
    </div>
    <!-- –ó–ê–î–ê–ù–ò–Ø -->
    <div id="tasks-section">
      <div class="task" id="task-card-1">
        <div class="task-title">üîç –ó–∞–¥–∞–Ω–∏–µ 1</div>
        <div class="task-desc">–ù–∞–π–¥–∏ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç –∫–æ–º–ø–∞–Ω–∏–∏ ¬´–ö–æ—Å–º–æ–¢–µ—Ö¬ª</div>
        <div class="task-footer">
          <span>10 –º–∏–Ω ‚Ä¢ 100 ‚ÇΩ</span>
          <button class="my-btn" id="start-task1">–ù–∞—á–∞—Ç—å ‚Üí</button>
        </div>
      </div>
      <div class="task" id="task-card-2">
        <div class="task-title">üì∑ –ó–∞–¥–∞–Ω–∏–µ 2</div>
        <div class="task-desc">–ó–∞–≥—Ä—É–∑–∏ —Ñ–æ—Ç–æ —Å —É–ª–∏—Ü—ã —Å –ø–æ–≥–æ–¥–æ–π —Å–µ–≥–æ–¥–Ω—è</div>
        <div class="task-footer">
          <span>5 –º–∏–Ω ‚Ä¢ 150 ‚ÇΩ</span>
          <button class="my-btn" id="start-task2">–ù–∞—á–∞—Ç—å ‚Üí</button>
        </div>
      </div>
      <div class="task" id="task-card-3">
        <div class="task-title">üßπ –ó–∞–¥–∞–Ω–∏–µ 3</div>
        <div class="task-desc">–û—á–∏—Å—Ç–∏ —Å –æ–±–ª–∞—á–Ω–æ–≥–æ –¥–∏—Å–∫–∞ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Ñ–æ—Ç–æ (200 —Ñ–∞–π–ª–æ–≤)</div>
        <div class="task-footer">
          <span>7 –º–∏–Ω ‚Ä¢ 700 ‚ÇΩ</span>
          <button class="my-btn" id="start-task3" disabled>–ù–∞—á–∞—Ç—å ‚Üí</button>
        </div>
        <button class="my-btn" id="show-access-code" style="margin-top:5px; width:100%; display:none;">–í–≤–µ—Å—Ç–∏ –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞</button>
      </div>
    </div>
    <!-- –õ–ò–ß–ù–´–ô –ö–ê–ë–ò–ù–ï–¢ -->
    <div id="profile-section" class="hidden">
      <div class="profile-card">
        <h2>üë§ –ü—Ä–∏–≤–µ—Ç, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h2>
        <p>–ë–∞–ª–∞–Ω—Å: <strong id="profile-balance">0 ‚ÇΩ</strong></p>
        <p>–í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–¥–∞–Ω–∏–π: <strong id="profile-tasks">0</strong></p>
      </div>
    </div>
  </div>
  <!-- –ú–û–î–ê–õ–ö–ò -->
  <div class="modal-bg" id="modal-task1">
    <div class="modal">
      <button class="close-btn" id="close-modal-task1">&times;</button>
      <div class="task-title">üîç –ó–∞–¥–∞–Ω–∏–µ 1</div>
      <div style="font-size:15px; margin:5px 0 10px 0;">–ù–∞–π–¥–∏ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç –∫–æ–º–ø–∞–Ω–∏–∏ ¬´–ö–æ—Å–º–æ–¢–µ—Ö¬ª –∏ –≤—Å—Ç–∞–≤—å —Å—Å—ã–ª–∫—É –Ω–∏–∂–µ:</div>
      <input type="text" id="task1-url" class="my-input" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ —Å–∞–π—Ç">
      <button class="my-btn" id="submit-task1">–ì–æ—Ç–æ–≤–æ</button>
    </div>
  </div>
  <div class="modal-bg" id="modal-task2">
    <div class="modal">
      <button class="close-btn" id="close-modal-task2">&times;</button>
      <div class="task-title">üì∑ –ó–∞–¥–∞–Ω–∏–µ 2</div>
      <div style="font-size:15px; margin:5px 0 10px 0;">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ —É–ª–∏—Ü—ã —Å –ø–æ–≥–æ–¥–æ–π —Å–µ–≥–æ–¥–Ω—è:</div>
      <input type="file" id="task2-photo" class="my-input" accept="image/*">
      <button class="my-btn" id="submit-task2">–ì–æ—Ç–æ–≤–æ</button>
    </div>
  </div>
  <div class="modal-bg" id="modal-task3">
    <div class="modal">
      <button class="close-btn" id="close-modal-task3">&times;</button>
      <div class="task-title">üßπ –ó–∞–¥–∞–Ω–∏–µ 3</div>
      <div style="font-size:15px; margin:5px 0 10px 0;">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ, —á—Ç–æ —É–¥–∞–ª–∏–ª–∏ –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Ñ–æ—Ç–æ (200 —Ñ–∞–π–ª–æ–≤):</div>
      <input type="text" id="task3-confirm" class="my-input" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ: –ì–æ—Ç–æ–≤–æ, —É–¥–∞–ª–∏–ª!">
      <button class="my-btn" id="submit-task3">–ì–æ—Ç–æ–≤–æ</button>
    </div>
  </div>
  <!-- –ú–û–î–ê–õ–ö–ê –ü–û–î–ü–ò–°–ö–ò -->
  <div class="modal-bg" id="modal-subscribe">
    <div class="modal">
      <div style="font-size:17px; font-weight:500; margin-bottom:4px;">–î–æ—Å—Ç—É–ø –∫ 3 –∑–∞–¥–∞–Ω–∏—é</div>
      <div style="text-align:left; margin:14px 0 18px 0; font-size:15px;">
        1. –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ 3 –∑–∞–¥–∞–Ω–∏—é ‚Äî <b>–Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É ¬´–ü–µ—Ä–µ–π—Ç–∏ –≤ –±–æ—Ç–∞¬ª</b><br>
        2. –ó–∞–∫—Ä–æ–π —ç—Ç–æ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –∑–∞–π–¥–∏ –≤ –±–æ—Ç–∞, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å
      </div>
      <a href="https://t.me/zzadacha_bot?start=getcode" target="_blank" class="tg-btn" style="margin-bottom:10px;">–ü–µ—Ä–µ–π—Ç–∏ –≤ –±–æ—Ç</a>
      <input type="text" id="access-code-input" class="my-input" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞">
      <button class="my-btn" id="check-access-code">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥</button>
    </div>
  </div>
  <div class="notify" id="notify"></div>
  <script>
    let tasksDone = JSON.parse(localStorage.getItem("tasksDone")) || [false, false, false];
    let taskPays = [100, 150, 700];
    let balance = Number(localStorage.getItem("balance")) || 0;
    let doneTasks = Number(localStorage.getItem("doneTasks")) || 0;
    let canOpenThirdTask = localStorage.getItem("canOpenThirdTask") === "true";
    let task3Placeholder = false;
    function saveProgress() {
      localStorage.setItem("tasksDone", JSON.stringify(tasksDone));
      localStorage.setItem("balance", balance.toString());
      localStorage.setItem("doneTasks", doneTasks.toString());
      localStorage.setItem("canOpenThirdTask", canOpenThirdTask ? "true" : "false");
    }
    function updateProfile() {
      document.getElementById("profile-balance").innerText = balance + " ‚ÇΩ";
      document.getElementById("profile-tasks").innerText = doneTasks;
    }
    function setTaskDone(idx) {
      tasksDone[idx] = true;
      const card = document.getElementById("task-card-" + (idx+1));
      if (!card.querySelector('.done-label')) {
        const label = document.createElement('div');
        label.className = 'done-label';
        label.innerText = '–í—ã–ø–æ–ª–Ω–µ–Ω–æ!';
        card.appendChild(label);
      }
      document.getElementById("start-task"+(idx+1)).disabled = true;
      saveProgress();
      updateAccessBtn();
    }
    function showNotify(message) {
      const notify = document.getElementById("notify");
      notify.textContent = message;
      notify.classList.add("show");
      setTimeout(() => {notify.classList.remove("show");}, 2300);
    }
    function showModal(id) { document.getElementById(id).classList.add("show"); }
    function closeModal(id) { document.getElementById(id).classList.remove("show"); }
    function updateAccessBtn() {
      const btn = document.getElementById("show-access-code");
      if (tasksDone[0] && tasksDone[1] && !canOpenThirdTask) {
        btn.style.display = "";
      } else {
        btn.style.display = "none";
      }
    }
    document.getElementById("show-access-code").addEventListener("click", () => {
      showModal("modal-subscribe");
    });
    // Tabs
    const tabButtons = document.querySelectorAll(".tab-btn");
    const tasksSection = document.getElementById("tasks-section");
    const profileSection = document.getElementById("profile-section");
    tabButtons.forEach(button => {
      button.addEventListener("click", () => {
        tabButtons.forEach(btn => btn.classList.remove("active"));
        button.classList.add("active");
        tasksSection.classList.add("hidden");
        profileSection.classList.add("hidden");
        if (button.dataset.tab === "tasks") tasksSection.classList.remove("hidden");
        else profileSection.classList.remove("hidden");
      });
    });
    // –ú–æ–¥–∞–ª–∫–∏ –ø–æ –∑–∞–¥–∞–Ω–∏—è–º
    document.getElementById("start-task1").addEventListener("click", () => {
      if (!tasksDone[0]) showModal("modal-task1");
    });
    document.getElementById("close-modal-task1").addEventListener("click", () => closeModal("modal-task1"));
    document.getElementById("submit-task1").addEventListener("click", () => {
      if (tasksDone[0]) return;
      const url = document.getElementById("task1-url").value.trim();
      if (url === "" || !url.startsWith("http")) {
        showNotify("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—Å—ã–ª–∫—É –Ω–∞ —Å–∞–π—Ç.");
        return;
      }
      balance += taskPays[0];
      doneTasks += 1;
      updateProfile();
      showNotify("–ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ! –ù–∞ –≤–∞—à –±–∞–ª–∞–Ω—Å –∑–∞—á–∏—Å–ª–µ–Ω–æ 100 ‚ÇΩ");
      setTaskDone(0);
      closeModal("modal-task1");
      document.getElementById("task1-url").value = "";
      checkAfterTwoTasks();
      saveProgress();
    });
    document.getElementById("start-task2").addEventListener("click", () => {
      if (!tasksDone[1]) showModal("modal-task2");
    });
    document.getElementById("close-modal-task2").addEventListener("click", () => closeModal("modal-task2"));
    document.getElementById("submit-task2").addEventListener("click", () => {
      if (tasksDone[1]) return;
      const fileInput = document.getElementById("task2-photo");
      if (fileInput.files.length === 0) {
        showNotify("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é.");
        return;
      }
      balance += taskPays[1];
      doneTasks += 1;
      updateProfile();
      showNotify("–ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ! –ù–∞ –≤–∞—à –±–∞–ª–∞–Ω—Å –∑–∞—á–∏—Å–ª–µ–Ω–æ 150 ‚ÇΩ");
      setTaskDone(1);
      closeModal("modal-task2");
      fileInput.value = "";
      checkAfterTwoTasks();
      saveProgress();
    });
    document.getElementById("start-task3").addEventListener("click", () => {
      if (!tasksDone[2] && canOpenThirdTask && !task3Placeholder) showModal("modal-task3");
    });
    document.getElementById("close-modal-task3").addEventListener("click", () => closeModal("modal-task3"));
    document.getElementById("submit-task3").addEventListener("click", () => {
      if (tasksDone[2]) return;
      const confirmInput = document.getElementById("task3-confirm").value.trim();
      if (confirmInput.length < 2) {
        showNotify("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.");
        return;
      }
      balance += taskPays[2];
      doneTasks += 1;
      updateProfile();
      showNotify("–ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ! –ù–∞ –≤–∞—à –±–∞–ª–∞–Ω—Å –∑–∞—á–∏—Å–ª–µ–Ω–æ 700 ‚ÇΩ");
      setTaskDone(2);
      closeModal("modal-task3");
      document.getElementById("task3-confirm").value = "";
      saveProgress();
    });
    function checkAfterTwoTasks() {
      if (tasksDone[0] && tasksDone[1] && !canOpenThirdTask) {
        showModal("modal-subscribe");
      }
      updateAccessBtn();
    }
    // –ö–û–î –î–û–°–¢–£–ü–ê
    const SECRET_CODE = "Zadacha2025";
    document.getElementById("check-access-code").addEventListener("click", () => {
      const code = document.getElementById("access-code-input").value.trim();
      if (code === SECRET_CODE) {
        canOpenThirdTask = true;
        closeModal("modal-subscribe");
        showNotify("–î–æ—Å—Ç—É–ø –∫ 3 –∑–∞–¥–∞–Ω–∏—é –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞!");
        document.getElementById("start-task3").disabled = true;
        showTask3Placeholder();
        task3Placeholder = true;
        updateAccessBtn();
        saveProgress();
      } else {
        showNotify("–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞!");
      }
    });
    function showTask3Placeholder() {
      const task3 = document.getElementById("task-card-3");
      let lockDiv = task3.querySelector('.lock-label');
      if (!lockDiv) {
        lockDiv = document.createElement('div');
        lockDiv.className = 'lock-label';
        lockDiv.style.cssText = "color:#d13c3c; background:#fde6e6; border-radius:8px; padding:4px 10px; margin-top:10px; font-size:14px;";
        task3.appendChild(lockDiv);
      }
      lockDiv.textContent = "–î–æ—Å—Ç—É–ø –∫ –∑–∞–¥–∞–Ω–∏—é –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞";
      lockDiv.style.display = "";
    }
    // INIT
    window.addEventListener('DOMContentLoaded', function() {
      for (let i = 0; i < tasksDone.length; i++) {
        if (tasksDone[i]) setTaskDone(i);
      }
      if (canOpenThirdTask) {
        document.getElementById("start-task3").disabled = false;
      }
      updateProfile();
      updateAccessBtn();
    });
  </script>
</body>
</html>
